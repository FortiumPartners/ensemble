metadata:
  name: ensemble:refine-trd
  description: Refine and enhance existing TRD with stakeholder feedback and additional detail
  version: 1.0.0
  lastUpdated: "2025-10-13"
  category: planning
  output_path: ensemble/refine-trd.md
  source: fortium

constraints:
  - DO NOT implement, build, or execute any technical work described in the TRD
  - This command ONLY refines the TRD document itself
  - The arguments describe what should be improved in the document, not what should be built
  - After refining the TRD, stop and wait for user approval before any implementation

mission:
  summary: |
    Refine and enhance an existing Technical Requirements Document based on stakeholder
    feedback, additional research, or identified gaps. Updates TRD while maintaining
    version history and traceability.

workflow:
  phases:
    - name: TRD Review
      order: 1
      steps:
        - order: 1
          title: Current TRD Analysis
          description: Review existing TRD content

        - order: 2
          title: Interview users
          description: |
            REQUIRED: Conduct user interview BEFORE making any changes.

            Use the AskUserQuestion tool to present questions interactively:
            - Ask questions ONE AT A TIME (not all at once)
            - Wait for user answer before asking the next question
            - Do NOT just write questions in your response text
            - The user should see interactive question UI prompts

            Ask about:
            - Technical clarity of implementation details
            - Architecture decisions and component design
            - Technology choices and justifications
            - Error handling and recovery mechanisms
            - Testing strategy and coverage requirements
            - Performance requirements and targets
            - Missing technical edge cases
            - Integration points and external dependencies

        - order: 3
          title: Feedback Integration
          description: Incorporate stakeholder feedback

    - name: Enhancement
      order: 2
      steps:
        - order: 1
          title: Content Refinement
          description: Enhance clarity, detail, and completeness

        - order: 2
          title: Validation
          description: Ensure all sections meet quality standards

    - name: Output Management
      order: 3
      steps:
        - order: 1
          title: TRD Update
          description: Update TRD with version history

expectedOutput:
  format: Refined Technical Requirements Document (PRD)
  structure:
    - name: Updated TRD
      description: Enhanced TRD with feedback incorporated

    - name: Version History
      description: Changelog of updates and refinements
